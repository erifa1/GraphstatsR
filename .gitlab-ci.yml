stages:
  - install
  - check

variables:
  R_VERSION: "4.1.0"

install_linux:
  stage: install
  image: rocker/r-ver:${R_VERSION}
  before_script:
  - apt-get update -qq && apt-get install -y --no-install-recommends
  - apt-get install -y git libcurl4-openssl-dev libssl-dev libxml2-dev libgmp3-dev libmpfr-dev cmake
  script:
    - R -e 'install.packages("remotes")'
    - R -e 'remotes::install_gitlab(repo = "etienne.rifa/graphstats", host = "forgemia.inra.fr")'
  artifacts:
    paths:
      - .Rcheck/
    expire_in: 1 day

check_linux:
  stage: check
  image: rocker/r-ver:${R_VERSION}
  script:
    - R CMD check --as-cran .
  dependencies:
    - install_linux
  artifacts:
    paths:
      - .Rcheck/
    expire_in: 1 day
